<Window
	x:Class="GimaSoft.GINA.TextWindow"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:local="clr-namespace:GimaSoft.GINA"
	xmlns:sys="clr-namespace:System;assembly=mscorlib"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:extToolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit/extended"
	Height="200"
	Width="400"
	ShowInTaskbar="False"
	AllowsTransparency="True"
	WindowStyle="None"
	Topmost="True"
	Background="#00FFFFFF"
	Visibility="{Binding Path=App.Configuration.EnableText, Converter='{StaticResource ConverterBooleanToVisibility}', FallbackValue=Visible}"
	Loaded="Window_Loaded">
	<Grid
		x:Name="MainGrid"
		Tag="{Binding Path=BackgroundFill}">
		<Panel.Background>
			<SolidColorBrush>
				<SolidColorBrush.Color>
					<MultiBinding
						Converter="{StaticResource ConverterColorTransition}">
						<Binding
							Path="Tag"
							RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType={x:Type Grid}}" />
						<Binding
							Path="Behavior.BackgroundFadedColor" />
						<Binding
							Path="Behavior.BackgroundColor" />
					</MultiBinding>
				</SolidColorBrush.Color>
			</SolidColorBrush>
		</Panel.Background>
		<FrameworkElement.Style>
			<Style
				TargetType="{x:Type Grid}">
				<Style.Triggers>
					<DataTrigger
						Value="False"
						Binding="{Binding Path=ShowFullBackground}">
						<TriggerBase.EnterActions>
							<BeginStoryboard>
								<Storyboard>
									<DoubleAnimation
										Storyboard.TargetProperty="Tag"
										From="1.0"
										To="0.0"
										FillBehavior="Stop"
										Duration="0:0:0.25" />
								</Storyboard>
							</BeginStoryboard>
						</TriggerBase.EnterActions>
					</DataTrigger>
					<DataTrigger
						Value="True"
						Binding="{Binding Path=ShowFullBackground}">
						<TriggerBase.EnterActions>
							<BeginStoryboard>
								<Storyboard>
									<DoubleAnimation
										Storyboard.TargetProperty="Tag"
										RepeatBehavior="1x"
										From="0.0"
										To="1.00"
										FillBehavior="Stop"
										Duration="0:0:0.25" />
								</Storyboard>
							</BeginStoryboard>
						</TriggerBase.EnterActions>
					</DataTrigger>
				</Style.Triggers>
			</Style>
		</FrameworkElement.Style>
		<Grid
			Background="#00FFFFFF"
			VerticalAlignment="Bottom"
			HorizontalAlignment="Stretch">
			<ListView
				x:Name="icTexts"
				BorderThickness="0"
				Background="#00FFFFFF"
				ScrollViewer.VerticalScrollBarVisibility="Hidden"
				ScrollViewer.HorizontalScrollBarVisibility="Disabled"
				HorizontalAlignment="Stretch"
				VerticalAlignment="Bottom"
				VerticalContentAlignment="Bottom"
				HorizontalContentAlignment="Center"
				ItemsSource="{Binding Path=Behavior.Matches}">
				<ItemsControl.ItemTemplate>
					<DataTemplate>
						<TextBlock
							TextWrapping="Wrap"
							HorizontalAlignment="Center"
							Height="Auto"
							Width="Auto"
							FontFamily="{Binding Path=DataContext.Behavior.Font.Name, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ItemsControl}}}"
							FontSize="{Binding Path=DataContext.Behavior.Font.Size, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ItemsControl}}}"
							Foreground="{Binding Path=TriggerFilter.TextStyle.FontColor}"
							Text="{Binding Path=DisplayText}">
							<UIElement.Effect>
								<DropShadowEffect
									Direction="330"
									Opacity="0.8"
									BlurRadius="4"
									ShadowDepth="{Binding Path=DataContext.TriggerFilter.TextStyle.ShadowDepth, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ItemsControl}}}"
									Color="{Binding Path=DataContext.TriggerFilter.TextStyle.ShadowColor, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ItemsControl}}}" />
							</UIElement.Effect>
						</TextBlock>
					</DataTemplate>
				</ItemsControl.ItemTemplate>
			</ListView>
		</Grid>
		<Grid
			Visibility="{Binding Path=ShowOpaqueWindow, Converter='{StaticResource ConverterBooleanToVisibility}'}">
			<Rectangle
				Fill="#40000000"
				Margin="6"
				MouseLeftButtonDown="TextBox_MouseLeftButtonDown"
				MouseMove="ResetCursor" />
			<Grid
				HorizontalAlignment="Stretch"
				VerticalAlignment="Stretch">
				<Grid.RowDefinitions>
					<RowDefinition
						Height="Auto" />
					<RowDefinition />
				</Grid.RowDefinitions>
				<Grid
					Row="0"
					VerticalAlignment="Top"
					HorizontalAlignment="Stretch"
					Background="#FF000080"
					Margin="6"
					MouseLeftButtonDown="TextBox_MouseLeftButtonDown">
					<WrapPanel
						HorizontalAlignment="Left"
						Orientation="Horizontal"
						Height="Auto"
						Margin="0">
						<FrameworkElement.Resources>
							<ResourceDictionary>
								<Style
									x:Key="{x:Type StackPanel}"
									TargetType="{x:Type StackPanel}">
									<Setter
										Property="Margin"
										Value="5 1 5 1" />
									<Setter
										Property="StackPanel.Orientation"
										Value="Horizontal" />
									<Setter
										Property="Background">
										<Setter.Value>
											<LinearGradientBrush
												StartPoint="0,0"
												EndPoint="0,1">
												<GradientStop
													Color="#00F0F0"
													Offset="0" />
												<GradientStop
													Color="Navy"
													Offset="0.2" />
												<GradientStop
													Color="Navy"
													Offset="0.8" />
												<GradientStop
													Color="#00F0F0"
													Offset="1" />
											</LinearGradientBrush>
										</Setter.Value>
									</Setter>
								</Style>
								<Style
									x:Key="{x:Type Label}"
									TargetType="{x:Type Label}">
									<Setter
										Property="Foreground"
										Value="#FFFFFFFF" />
								</Style>
							</ResourceDictionary>
						</FrameworkElement.Resources>
						<StackPanel>
							<Label
								Content="Font: " />
							<ComboBox
								Width="100"
								ItemsSource="{Binding Path=FontNames}"
								SelectedValue="{Binding Path=Behavior.FontName}" />
						</StackPanel>
						<StackPanel>
							<Label
								Content="Size: " />
							<extToolkit:IntegerUpDown
								Minimum="8"
								Maximum="200"
								Width="50"
								Value="{Binding Path=Behavior.FontSize, Mode=TwoWay}" />
						</StackPanel>
						<StackPanel>
							<Label
								Content="Fade Delay: " />
							<extToolkit:IntegerUpDown
								Minimum="1"
								Maximum="120"
								Width="50"
								Value="{Binding Path=Behavior.TextFadeTime, Mode=TwoWay}" />
						</StackPanel>
						<StackPanel>
							<Label
								Content="Background:" />
							<extToolkit:ColorPicker
								ShowAvailableColors="False"
								ShowRecentColors="True"
								Width="60"
								SelectedColor="{Binding Path=Behavior.BackgroundColor, Mode=TwoWay}" />
						</StackPanel>
						<StackPanel>
							<Label
								Content="Faded Background:" />
							<extToolkit:ColorPicker
								ShowAvailableColors="False"
								ShowRecentColors="True"
								Width="60"
								SelectedColor="{Binding Path=Behavior.BackgroundFadedColor, Mode=TwoWay}" />
						</StackPanel>
					</WrapPanel>
				</Grid>
				<Grid
					VerticalAlignment="Center"
					HorizontalAlignment="Center"
					Row="1">
					<TextBox
						Background="#00FFFFFF"
						Foreground="#FFFFFF00"
						Text="{Binding Path=BehaviorName}"
						FontFamily="{Binding Path=Behavior.Font.Name}"
						FontSize="{Binding Path=Behavior.Font.Size}">
						<UIElement.Effect>
							<DropShadowEffect
								ShadowDepth="5"
								Direction="330"
								Color="Black"
								Opacity="0.8"
								BlurRadius="4" />
						</UIElement.Effect>
					</TextBox>
				</Grid>
				<Button
					Content="Save"
					HorizontalAlignment="Right"
					VerticalAlignment="Top"
					Margin="0 8 8 2"
					Command="{Binding Path=SaveWindowCommand}" />
			</Grid>
			<Rectangle
				x:Name="top"
				Fill="#40000000"
				VerticalAlignment="Top"
				Height="6"
				Margin="6,0,6,0"
				Stroke="{x:Null}"
				PreviewMouseDown="Resize"
				MouseMove="DisplayResizeCursor" />
			<Rectangle
				x:Name="bottom"
				Fill="#40000000"
				Height="6"
				VerticalAlignment="Bottom"
				Margin="6,0,6,0"
				Stroke="{x:Null}"
				PreviewMouseDown="Resize"
				MouseMove="DisplayResizeCursor" />
			<Rectangle
				x:Name="left"
				Fill="#40000000"
				HorizontalAlignment="Left"
				Margin="0,6,0,6"
				Width="6"
				Stroke="{x:Null}"
				PreviewMouseDown="Resize"
				MouseMove="DisplayResizeCursor" />
			<Rectangle
				x:Name="right"
				Fill="#40000000"
				Margin="0,6,0,6"
				Width="6"
				HorizontalAlignment="Right"
				Stroke="{x:Null}"
				PreviewMouseDown="Resize"
				MouseMove="DisplayResizeCursor" />
			<Rectangle
				x:Name="bottomLeft"
				Fill="#40000000"
				HorizontalAlignment="Left"
				VerticalAlignment="Bottom"
				Width="6"
				Height="6"
				Stroke="{x:Null}"
				PreviewMouseDown="Resize"
				MouseMove="DisplayResizeCursor" />
			<Rectangle
				x:Name="bottomRight"
				Fill="#40000000"
				VerticalAlignment="Bottom"
				Height="6"
				Width="6"
				HorizontalAlignment="Right"
				Stroke="{x:Null}"
				PreviewMouseDown="Resize"
				MouseMove="DisplayResizeCursor" />
			<Rectangle
				x:Name="topRight"
				Fill="#40000000"
				HorizontalAlignment="Right"
				Width="6"
				Height="6"
				VerticalAlignment="Top"
				Stroke="{x:Null}"
				PreviewMouseDown="Resize"
				MouseMove="DisplayResizeCursor" />
			<Rectangle
				x:Name="topLeft"
				Fill="#40000000"
				HorizontalAlignment="Left"
				Width="6"
				VerticalAlignment="Top"
				Height="6"
				Stroke="{x:Null}"
				PreviewMouseLeftButtonDown="Resize"
				MouseMove="DisplayResizeCursor" />
		</Grid>
	</Grid>
</Window>
